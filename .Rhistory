fit_HYP <- fit.hypmv(val.ln)         # Hyperbolic
fit_VG  <- fit.VGmv(val.ln)          # Variance-Gamma
AIC_vals <- c(
GH  = AIC(fit_GH),
NIG = AIC(fit_NIG),
HYP = AIC(fit_HYP),
VG  = AIC(fit_VG)
)
print(AIC_vals)
best_model_name <- names(which.min(AIC_vals))
best_fit <- switch(
best_model_name,
GH  = fit_GH,
NIG = fit_NIG,
HYP = fit_HYP,
VG  = fit_VG
)
cat("Best GH-type model selected by AIC:", best_model_name, "\n")
R_sim <- ghyp::rghyp(rep, best_fit)
port_ret_sim <- as.numeric(R_sim %*% w)
loss_sim <- -port_ret_sim
VaR$GHYP <- quantile(loss_sim, probs = alpha, type = 7)
ES$GHYP <- mean(loss_sim[loss_sim>VaR$GHYP])
VaR$GHYP <- quantile(loss_sim, probs = alpha, type = 7)
library(copula)
mu_hat <- colMeans(val.ln)
sd_hat <- apply(val.ln, 2, sd)
U_norm <- pnorm(
sweep(val.ln, 2, mu_hat, "-"),
sd = sd_hat
)
gumbel_cop <- gumbelCopula(dim = d)
library(copula)
mu_hat <- colMeans(val.ln)
sd_hat <- apply(val.ln, 2, sd)
U_norm <- pnorm(
sweep(val.ln, 2, mu_hat, "-"),
sd = sd_hat
)
gumbel_cop <- gumbelCopula(dim = ncol(val.ln))
fit_gumbel_norm <- fitCopula(
gumbel_cop,
data = U_norm,
method = "ml"
)
U_sim <- rCopula(rep, fit_gumbel_norm@copula)
R_sim <- qnorm(
U_sim,
mean = matrix(mu_hat, rep, d, byrow = TRUE),
sd   = matrix(sd_hat, rep, d, byrow = TRUE)
)
library(copula)
mu_hat <- colMeans(val.ln)
sd_hat <- apply(val.ln, 2, sd)
U_norm <- pnorm(
sweep(val.ln, 2, mu_hat, "-"),
sd = sd_hat
)
gumbel_cop <- gumbelCopula(dim = ncol(val.ln))
fit_gumbel_norm <- fitCopula(
gumbel_cop,
data = U_norm,
method = "ml"
)
U_sim <- rCopula(rep, fit_gumbel_norm@copula)
R_sim <- qnorm(
U_sim,
mean = matrix(mu_hat, rep, ncol(val.ln), byrow = TRUE),
sd   = matrix(sd_hat, rep, ncol(val.ln), byrow = TRUE)
)
loss_sim <- -as.numeric(R_sim %*% w)
VaR_Gumbel_Norm <- quantile(loss_sim, probs = alpha, type = 7)
ES$Cop.Gumb.Norm <- mean(loss_sim[loss_sim > VaR$Cop.Gumb.Norm])
VaR$Cop.Gumb.Norm <- quantile(loss_sim, probs = alpha, type = 7)
VaR$Cop.Gumb.Norm <- quantile(loss_sim, probs = alpha, type = 7)
VaR$Cop.Gumb.Norm
mean(loss_sim[loss_sim > VaR$Cop.Gumb.Norm])
U_t <- pt(
sweep(R, 2, colMeans(val.ln), "-") / sqrt(diag(cov(val.ln))),
df = 5
)
U_t <- pt(
sweep(val.ln, 2, colMeans(val.ln), "-") / sqrt(diag(cov(val.ln))),
df = 5
)
fit_gumbel_t <- fitCopula(gumbel_cop, data = U_t, method = "ml")
U_sim <- rCopula(rep, fit_gumbel_t@copula)
R_sim <- qt(U_sim, df = df_marg) *
matrix(sqrt(diag(cov(val.ln))), rep, ncol(val.ln), byrow = TRUE) +
matrix(mu_hat, rep, ncol(val.ln), byrow = TRUE)
U_t <- pt(
sweep(val.ln, 2, colMeans(val.ln), "-") / sqrt(diag(cov(val.ln))),
df = 5
)
fit_gumbel_t <- fitCopula(gumbel_cop, data = U_t, method = "ml")
U_sim <- rCopula(rep, fit_gumbel_t@copula)
R_sim <- qt(U_sim, df = 5) *
matrix(sqrt(diag(cov(val.ln))), rep, ncol(val.ln), byrow = TRUE) +
matrix(mu_hat, rep, ncol(val.ln), byrow = TRUE)
loss_sim <- -as.numeric(R_sim %*% w)
VaR$Cop.Gumb.t <- quantile(loss_sim, probs = alpha, type = 7)
ES$Cop.Gumb.t = mean(loss_sim[loss_sim > VaR$Cop.Gumb.t])
ncol(val.ln)
n
X.E
rm(list=ls()) # remove all variables from enviroment
VaR = list()
ES = list()
library(readxl)
library(QRM)
library(mvtnorm)
library(ghyp)
library(copula)
equity <- read_excel("Prices 2025.xlsx", col_names = TRUE)
equity <- as.data.frame(equity)
names(equity) <- trimws(names(equity))
names(equity) <- gsub("\\s+", "_", names(equity))
names(equity) <- toupper(names(equity))
print(names(equity))
cols_precio <- c("BMW","MBG","VOW3")
equity[ , cols_precio] <- lapply(equity[ , cols_precio], function(x) {
if (is.character(x)) x <- gsub(",", ".", x)
as.numeric(x)
})
str(equity[ , cols_precio])
summary(equity)  # 8) Resumen general del dataframe
prices <- equity[ , cols_precio, drop = FALSE]
summary(prices)
val <- as.matrix(prices)
n <- nrow(val)
hist(val[,"BMW"], 20)   # con 20 intervalos
X <- diff(log(val))
colnames(X) <- colnames(val)
X.E <- colMeans(X)
X.E <- as.matrix(X.E)  # matriz columna
X.Cov  <- var(X)
X.Covn <- (n - 1) * X.Cov / n
(X.Covn <- as.matrix(X.Covn))
hist(X[,"BMW"], 20)
series.X <- ts(X, start = c(2020, 180), frequency = 252)
plot(series.X, main = "Rendimientos logarítmicos (BMW, MBG, VOW3)")
plot(X[,"BMW"], type = "l", ylim = c(-0.15, 0.15), main = "Rend. BMW (-0.15, 0.15)")
lines(X[,"MBG"],  lty = 2, col = "blue")
lines(X[,"VOW3"], lty = 3, col = "green")
w <- c(.432653233946286, .365381615772939, .201965150937368)
w <- as.matrix(w)
sum(w)  # debería ser 1
V <- 1
(EL <- V * t(w) %*% X.E)
(VL <- V^2 * (t(w) %*% X.Covn %*% w))
EL_V <- EL * 250000
alpha <- 0.99
VaR$VarCovar.Norm = qnorm(alpha, mean = EL, sd = sqrt(VL))
ES$VarCovar.Norm =EL + sqrt(VL) * dnorm(qnorm(alpha)) / (1 - alpha)
mu <- EL
nu <- 3
sigma2 <- VL * (nu - 2) / nu
VaR$VarCovar.t <- mu + sqrt(sigma2) * qt(alpha, nu)
ES$VarCovar.t <- EL + sqrt(sigma2) * (dt(qt(alpha, nu), nu) / (1 - alpha)) * (nu + qt(alpha, nu)^2) / (nu - 1)
qnorm(alpha, mean = EL, sd = sqrt(VL))
ESnorm(alpha, mu = EL, sd = sqrt(VL))
qst(alpha, 4, mu = EL, sd = sqrt(sigma2))
ESst(alpha, 4, mu = EL, sd = sqrt(sigma2))
SH.L <- (-V) * (X %*% w)
summary(SH.L);
hist(SH.L, 20, main = "Simulación histórica - pérdidas")
mod.gauss <- fit.norm(SH.L)
mod.t     <- fit.st(SH.L)
mod.gauss; summary(mod.gauss)
attributes(mod.t)
AIC_n <- 2*2 - 2*mod.gauss$ll.max
AIC_t <- 2*3 - 2*mod.t$ll.max
AIC_n; AIC_t
VaR$Hist.Norm = qnorm(alpha, mean = mod.gauss$mu, sd = sqrt(mod.gauss$Sigma))
ES$Hist.Norm = ESnorm(alpha, mu = mod.gauss$mu, sd = sqrt(mod.gauss$Sigma))
VaR$Hist.t = qst(alpha, 4, mu = mod.t$par.ests[2], sd = mod.t$par.ests[3])
ES$Hist.t = ESst(alpha, 4, mu = mod.t$par.ests[2], sd = mod.t$par.ests[3])
qst(alpha, mod.t$par.ests[1], mu = mod.t$par.ests[2], sd = mod.t$par.ests[3])
ESst(alpha, mod.t$par.ests[1], mu = mod.t$par.ests[2], sd = mod.t$par.ests[3])
VaR99 <- quantile(SH.L, alpha, type = 1)
ES99  <- mean(SH.L[SH.L > VaR99])
VaR99; ES99
rep <- 1000000
MC.data <- rmvnorm(rep, mean = as.numeric(X.E), sigma = X.Covn)
MC.data <- as.matrix(MC.data)
MC.Lsim <- -V * (MC.data %*% w)
VaR$MC.Norm = quantile(MC.Lsim, alpha)
ES$MC.Norm  = mean(MC.Lsim[MC.Lsim > VaR$MC.Norm])
MC.data <- rmvt(rep, df=3, delta = as.numeric(X.E), sigma = X.Covn)
MC.data <- as.matrix(MC.data)
MC.Lsim <- -V * (MC.data %*% w)
VaR$MC.t = quantile(MC.Lsim, alpha)
ES$MC.t  = mean(MC.Lsim[MC.Lsim > VaR$MC.t])
fit_GH  <- fit.ghypmv(X)        # GH general
fit_NIG <- fit.NIGmv(X)         # Normal-Inverse-Gaussian
fit_HYP <- fit.hypmv(X)         # Hyperbolic
fit_VG  <- fit.VGmv(X)          # Variance-Gamma
AIC_vals <- c(
GH  = AIC(fit_GH),
NIG = AIC(fit_NIG),
HYP = AIC(fit_HYP),
VG  = AIC(fit_VG)
)
print(AIC_vals)
best_model_name <- names(which.min(AIC_vals))
best_fit <- switch(
best_model_name,
GH  = fit_GH,
NIG = fit_NIG,
HYP = fit_HYP,
VG  = fit_VG
)
cat("Best GH-type model selected by AIC:", best_model_name, "\n")
R_sim <- ghyp::rghyp(rep, best_fit)
port_ret_sim <- as.numeric(R_sim %*% w)
loss_sim <- -port_ret_sim
VaR$GHYP <- quantile(loss_sim, probs = alpha, type = 7)
ES$GHYP <- mean(loss_sim[loss_sim>VaR$GHYP])
mu_hat <- colMeans(X)
sd_hat <- apply(X, 2, sd)
U_norm <- pnorm(
sweep(X, 2, mu_hat, "-"),
sd = sd_hat
)
gumbel_cop <- gumbelCopula(dim = ncol(X))
fit_gumbel_norm <- fitCopula(
gumbel_cop,
data = U_norm,
method = "ml"
)
U_sim <- rCopula(rep, fit_gumbel_norm@copula)
R_sim <- qnorm(
U_sim,
mean = matrix(mu_hat, rep, ncol(X), byrow = TRUE),
sd   = matrix(sd_hat, rep, ncol(X), byrow = TRUE)
)
loss_sim <- -as.numeric(R_sim %*% w)
VaR$Cop.Gumb.Norm <- quantile(loss_sim, probs = alpha, type = 7)
ES$Cop.Gumb.Norm <- mean(loss_sim[loss_sim > VaR$Cop.Gumb.Norm])
U_t <- pt(
sweep(X, 2, colMeans(X), "-") / sqrt(diag(cov(X))),
df = 5
)
fit_gumbel_t <- fitCopula(gumbel_cop, data = U_t, method = "ml")
U_sim <- rCopula(rep, fit_gumbel_t@copula)
R_sim <- qt(U_sim, df = 5) *
matrix(sqrt(diag(cov(X))), rep, ncol(X), byrow = TRUE) +
matrix(mu_hat, rep, ncol(X), byrow = TRUE)
loss_sim <- -as.numeric(R_sim %*% w)
VaR$Cop.Gumb.t <- quantile(loss_sim, probs = alpha, type = 7)
ES$Cop.Gumb.t = mean(loss_sim[loss_sim > VaR$Cop.Gumb.t])
X.E
mu_hat
mu_hat <- colMeans(X)
sd_hat <- apply(X, 2, sd)
U_norm <- pnorm(
sweep(X, 2, X.E, "-"),
sd = sd_hat
)
gumbel_cop <- gumbelCopula(dim = ncol(X))
fit_gumbel_norm <- fitCopula(
gumbel_cop,
data = U_norm,
method = "ml"
)
U_sim <- rCopula(rep, fit_gumbel_norm@copula)
R_sim <- qnorm(
U_sim,
mean = matrix(mu_hat, rep, ncol(X), byrow = TRUE),
sd   = matrix(sd_hat, rep, ncol(X), byrow = TRUE)
)
loss_sim <- -as.numeric(R_sim %*% w)
VaR$Cop.Gumb.Norm <- quantile(loss_sim, probs = alpha, type = 7)
ES$Cop.Gumb.Norm <- mean(loss_sim[loss_sim > VaR$Cop.Gumb.Norm])
X.s <- apply(X, 2, sd)
c
ncol(val)
var(X)
cov(X)
clayton_cop <- claytonCopula(dim = nc)
rm(list=ls()) # remove all variables from enviroment
VaR = list()
ES = list()
library(readxl)
library(QRM)
library(mvtnorm)
library(ghyp)
library(copula)
equity <- read_excel("Prices 2025.xlsx", col_names = TRUE)
equity <- as.data.frame(equity)
names(equity) <- trimws(names(equity))
names(equity) <- gsub("\\s+", "_", names(equity))
names(equity) <- toupper(names(equity))
print(names(equity))
cols_precio <- c("BMW","MBG","VOW3")
equity[ , cols_precio] <- lapply(equity[ , cols_precio], function(x) {
if (is.character(x)) x <- gsub(",", ".", x)
as.numeric(x)
})
str(equity[ , cols_precio])
summary(equity)  # 8) Resumen general del dataframe
prices <- equity[ , cols_precio, drop = FALSE]
summary(prices)
val <- as.matrix(prices)
n <- nrow(val)
nc = ncol(val)
hist(val[,"BMW"], 20)   # con 20 intervalos
X <- diff(log(val))
colnames(X) <- colnames(val)
X.E <- colMeans(X)
X.E <- as.matrix(X.E)  # matriz columna
X.s <- apply(X, 2, sd)
X.Cov  <- var(X)
X.Covn <- (n - 1) * X.Cov / n
(X.Covn <- as.matrix(X.Covn))
hist(X[,"BMW"], 20)
series.X <- ts(X, start = c(2020, 180), frequency = 252)
plot(series.X, main = "Rendimientos logarítmicos (BMW, MBG, VOW3)")
plot(X[,"BMW"], type = "l", ylim = c(-0.15, 0.15), main = "Rend. BMW (-0.15, 0.15)")
lines(X[,"MBG"],  lty = 2, col = "blue")
lines(X[,"VOW3"], lty = 3, col = "green")
w <- c(.432653233946286, .365381615772939, .201965150937368)
w <- as.matrix(w)
sum(w)  # debería ser 1
V <- 1
(EL <- V * t(w) %*% X.E)
(VL <- V^2 * (t(w) %*% X.Covn %*% w))
EL_V <- EL * 250000
alpha <- 0.99
VaR$VarCovar.Norm = qnorm(alpha, mean = EL, sd = sqrt(VL))
ES$VarCovar.Norm =EL + sqrt(VL) * dnorm(qnorm(alpha)) / (1 - alpha)
mu <- EL
nu <- 3
sigma2 <- VL * (nu - 2) / nu
VaR$VarCovar.t <- mu + sqrt(sigma2) * qt(alpha, nu)
ES$VarCovar.t <- EL + sqrt(sigma2) * (dt(qt(alpha, nu), nu) / (1 - alpha)) * (nu + qt(alpha, nu)^2) / (nu - 1)
qnorm(alpha, mean = EL, sd = sqrt(VL))
ESnorm(alpha, mu = EL, sd = sqrt(VL))
qst(alpha, 4, mu = EL, sd = sqrt(sigma2))
ESst(alpha, 4, mu = EL, sd = sqrt(sigma2))
SH.L <- (-V) * (X %*% w)
summary(SH.L);
hist(SH.L, 20, main = "Simulación histórica - pérdidas")
mod.gauss <- fit.norm(SH.L)
mod.t     <- fit.st(SH.L)
mod.gauss; summary(mod.gauss)
attributes(mod.t)
AIC_n <- 2*2 - 2*mod.gauss$ll.max
AIC_t <- 2*3 - 2*mod.t$ll.max
AIC_n; AIC_t
VaR$Hist.Norm = qnorm(alpha, mean = mod.gauss$mu, sd = sqrt(mod.gauss$Sigma))
ES$Hist.Norm = ESnorm(alpha, mu = mod.gauss$mu, sd = sqrt(mod.gauss$Sigma))
VaR$Hist.t = qst(alpha, 4, mu = mod.t$par.ests[2], sd = mod.t$par.ests[3])
ES$Hist.t = ESst(alpha, 4, mu = mod.t$par.ests[2], sd = mod.t$par.ests[3])
qst(alpha, mod.t$par.ests[1], mu = mod.t$par.ests[2], sd = mod.t$par.ests[3])
ESst(alpha, mod.t$par.ests[1], mu = mod.t$par.ests[2], sd = mod.t$par.ests[3])
VaR99 <- quantile(SH.L, alpha, type = 1)
ES99  <- mean(SH.L[SH.L > VaR99])
VaR99; ES99
rep <- 1000000
MC.data <- rmvnorm(rep, mean = as.numeric(X.E), sigma = X.Covn)
MC.data <- as.matrix(MC.data)
MC.Lsim <- -V * (MC.data %*% w)
VaR$MC.Norm = quantile(MC.Lsim, alpha)
ES$MC.Norm  = mean(MC.Lsim[MC.Lsim > VaR$MC.Norm])
MC.data <- rmvt(rep, df=3, delta = as.numeric(X.E), sigma = X.Covn)
MC.data <- as.matrix(MC.data)
MC.Lsim <- -V * (MC.data %*% w)
VaR$MC.t = quantile(MC.Lsim, alpha)
ES$MC.t  = mean(MC.Lsim[MC.Lsim > VaR$MC.t])
fit_GH  <- fit.ghypmv(X)        # GH general
fit_NIG <- fit.NIGmv(X)         # Normal-Inverse-Gaussian
fit_HYP <- fit.hypmv(X)         # Hyperbolic
fit_VG  <- fit.VGmv(X)          # Variance-Gamma
AIC_vals <- c(
GH  = AIC(fit_GH),
NIG = AIC(fit_NIG),
HYP = AIC(fit_HYP),
VG  = AIC(fit_VG)
)
print(AIC_vals)
best_model_name <- names(which.min(AIC_vals))
best_fit <- switch(
best_model_name,
GH  = fit_GH,
NIG = fit_NIG,
HYP = fit_HYP,
VG  = fit_VG
)
cat("Best GH-type model selected by AIC:", best_model_name, "\n")
R_sim <- ghyp::rghyp(rep, best_fit)
port_ret_sim <- as.numeric(R_sim %*% w)
loss_sim <- -port_ret_sim
VaR$GHYP <- quantile(loss_sim, probs = alpha, type = 7)
ES$GHYP <- mean(loss_sim[loss_sim>VaR$GHYP])
U_norm <- pnorm(sweep(X, 2, X.E, "-"), sd = E.s)
U_norm <- pnorm(sweep(X, 2, X.E, "-"), sd = X.s)
gumbel_cop <- gumbelCopula(dim = nc)
fit_gumbel_norm <- fitCopula(
gumbel_cop,
data = U_norm,
method = "ml"
)
U_sim <- rCopula(rep, fit_gumbel_norm@copula)
R_sim <- qnorm(
U_sim,
mean = matrix(E.X, rep, nc, byrow = TRUE),
sd   = matrix(E.s, rep, nc, byrow = TRUE)
)
U_norm <- pnorm(sweep(X, 2, X.E, "-"), sd = X.s)
gumbel_cop <- gumbelCopula(dim = nc)
fit_gumbel_norm <- fitCopula(
gumbel_cop,
data = U_norm,
method = "ml"
)
U_sim <- rCopula(rep, fit_gumbel_norm@copula)
R_sim <- qnorm(
U_sim,
mean = matrix(X.E, rep, nc, byrow = TRUE),
sd   = matrix(X.s, rep, nc, byrow = TRUE)
)
loss_sim <- -as.numeric(R_sim %*% w)
VaR$Cop.Gumb.Norm <- quantile(loss_sim, probs = alpha, type = 7)
ES$Cop.Gumb.Norm <- mean(loss_sim[loss_sim > VaR$Cop.Gumb.Norm])
U_t <- pt(
sweep(X, 2, colMeans(X), "-") / sqrt(diag(X.Cov)),
df = 5
)
fit_gumbel_t <- fitCopula(gumbel_cop, data = U_t, method = "ml")
U_sim <- rCopula(rep, fit_gumbel_t@copula)
R_sim <- qt(U_sim, df = 5) *
matrix(sqrt(diag(X.Cov)), rep, nc, byrow = TRUE) +
matrix(E.X, rep, nc, byrow = TRUE)
U_t <- pt(
sweep(X, 2, colMeans(X), "-") / sqrt(diag(X.Cov)),
df = 5
)
fit_gumbel_t <- fitCopula(gumbel_cop, data = U_t, method = "ml")
U_sim <- rCopula(rep, fit_gumbel_t@copula)
R_sim <- qt(U_sim, df = 5) *
matrix(sqrt(diag(X.Cov)), rep, nc, byrow = TRUE) +
matrix(X.E, rep, nc, byrow = TRUE)
loss_sim <- -as.numeric(R_sim %*% w)
VaR$Cop.Gumb.t <- quantile(loss_sim, probs = alpha, type = 7)
ES$Cop.Gumb.t = mean(loss_sim[loss_sim > VaR$Cop.Gumb.t])
clayton_cop <- claytonCopula(dim = nc)
fit_clayton_norm <- fitCopula(clayton_cop, data = U_norm, method = "ml")
U_sim <- rCopula(n_sim, fit_clayton_norm@copula)
clayton_cop <- claytonCopula(dim = nc)
fit_clayton_norm <- fitCopula(clayton_cop, data = U_norm, method = "ml")
U_sim <- rCopula(rep, fit_clayton_norm@copula)
R_sim <- qnorm(
U_sim,
mean = matrix(X.E, rep, nc, byrow = TRUE),
sd   = matrix(X.s, rep, nc, byrow = TRUE)
)
loss_sim <- -as.numeric(R_sim %*% w)
VaR$Cop.Clay.Norm = quantile(loss_sim, probs = alpha, type = 7)
ES$Cop.Clay.Norm = mean(loss_sim[loss_sim > VaR$Cop.Clay.Norm])
ES
VaR
mod.t
?fit.sh
?fit.st
Sigma_hat <- cov(R)
fit_clayton_t <- fitCopula(clayton_cop, data = U_t, method = "ml")
U_sim <- rCopula(rep, fit_clayton_t@copula)
R_sim <- qt(U_sim, df = nu) *
matrix(sqrt(diag(X.s)), rep, d, byrow = TRUE) +
matrix(X.E, rep, nc, byrow = TRUE)
fit_clayton_t <- fitCopula(clayton_cop, data = U_t, method = "ml")
U_sim <- rCopula(rep, fit_clayton_t@copula)
R_sim <- qt(U_sim, df = nu) *
matrix(sqrt(diag(X.s)), rep, nc, byrow = TRUE) +
matrix(X.E, rep, nc, byrow = TRUE)
loss_sim <- -as.numeric(R_sim %*% w)
VaR$Cop.Clay.t <- quantile(loss_sim, probs = alpha, type = 7)
ES$Cop.Clay.t = mean(loss_sim[loss_sim > VaR$Cop.Clay.t])
VaR$Cop.Clay.t
ES$Cop.Clay.t
R_sim <- qt(U_sim, df = nu) *
matrix(sqrt(diag(X.Cov)), rep, nc, byrow = TRUE) +
matrix(X.E, rep, nc, byrow = TRUE)
loss_sim <- -as.numeric(R_sim %*% w)
VaR$Cop.Clay.t <- quantile(loss_sim, probs = alpha, type = 7)
ES$Cop.Clay.t = mean(loss_sim[loss_sim > VaR$Cop.Clay.t])
ES$Cop.Clay.t
VaR$Cop.Clay.t
t_cop <- tCopula(dim = nc, dispstr = "un")
fit_tc_t <- fitCopula(t_cop, data = U_t, method = "ml")
U_sim <- rCopula(rep, fit_tc_t@copula)
R_sim <- qt(U_sim, df = nu) *
matrix(sqrt(diag(Sigma_hat)), rep, nc, byrow = TRUE) +
matrix(mu_hat, rep, nc, byrow = TRUE)
t_cop <- tCopula(dim = nc, dispstr = "un")
fit_tc_t <- fitCopula(t_cop, data = U_t, method = "ml")
U_sim <- rCopula(rep, fit_tc_t@copula)
R_sim <- qt(U_sim, df = nu) *
matrix(sqrt(diag(E.Cov)), rep, nc, byrow = TRUE) +
matrix(mu_hat, rep, nc, byrow = TRUE)
t_cop <- tCopula(dim = nc, dispstr = "un")
fit_tc_t <- fitCopula(t_cop, data = U_t, method = "ml")
U_sim <- rCopula(rep, fit_tc_t@copula)
R_sim <- qt(U_sim, df = nu) *
matrix(sqrt(diag(X.Cov)), rep, nc, byrow = TRUE) +
matrix(X.E, rep, nc, byrow = TRUE)
loss_sim <- -as.numeric(R_sim %*% w)
VaR$Cop.t.t  <- quantile(loss_sim, probs = alpha_levels, type = 7)
VaR$Cop.t.t  <- quantile(loss_sim, probs = alpha, type = 7)
ES$Cop.t.t = mean(loss_sim[loss_sim > VaR$Cop.t.t])
VaR
